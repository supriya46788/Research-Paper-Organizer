<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sign Up - Research Paper Organizer</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
  <link rel="stylesheet" href="css/auth.css" />
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />

  <style>
    #darkModeToggle {
      position: absolute;
      top: 20px;
      right: 20px;
      background-color: #f3f4f6;
      border: none;
      padding: 10px;
      border-radius: 10px;
      cursor: pointer;
      z-index: 100;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s ease;
      font-size: 18px;
    }

    body.dark-mode #darkModeToggle {
      background-color: #1f2937;
      color: #f9fafb;
    }

    /* Core Styles */
    .auth-card { position: relative; }
    .close-btn {
      position: absolute;
      top: 15px;
      left: 15px;
      background: transparent;
      border: none;
      font-size: 20px;
      cursor: pointer;
      color: #374151;
      z-index: 50;
    }

    .progress-bar-fill {
      height: 100%;
      width: 0;
      background: #2563eb;
      border-radius: 4px;
      transition: width 0.3s ease-in-out;
    }

    .password-requirements li { color: red; }
    .password-requirements li.valid { color: green; }
    .password-requirements li::before {
      content: "âœ– ";
      color: red;
    }
    .password-requirements li.valid::before {
      content: "âœ” ";
      color: green;
    }

    .input-container {
      position: relative;
      display: flex;
      align-items: center;
    }

    .input-container input {
      width: 100%;
      padding-left: 35px;
      height: 40px;
      border-radius: 6px;
      border: 1px solid #d1d5db;
      outline: none;
    }

    .input-container i {
      position: absolute;
      left: 10px;
      color: #9ca3af;
      pointer-events: none;
      font-size: 14px;
      transition: color 0.2s ease;
    }

    .input-container input:focus + i {
      color: #2563eb;
    }

    /* ðŸ”¥ DARK MODE STYLES */
    body.dark-mode {
      background-color: #1f2937;
      color: #f9fafb;
    }

    body.dark-mode .auth-card,
    body.dark-mode input {
      background-color: #374151;
      color: #f9fafb;
      border-color: #4b5563;
    }

    body.dark-mode input::placeholder {
      color: #9ca3af;
    }

    body.dark-mode .input-container i {
      color: #9ca3af;
    }

    body.dark-mode .auth-btn {
      background-color: #2563eb;
      color: white;
    }
  </style>
</head>
<body>
  <div class="auth-container">
    <div class="auth-card">

      <!-- Close and Dark Mode Buttons -->
      <button class="close-btn" onclick="window.location.href='index.html'">âœ–</button>
      <button id="darkModeToggle" aria-label="Toggle Dark Mode">
        <i class="fas fa-moon"></i>
      </button>

      <!-- Progress Bar -->
      <div class="signup-progress" style="margin-top:40px">
        <div class="progress-bar-bg">
          <div class="progress-bar-fill" id="signupProgressBar"></div>
        </div>
        <div class="progress-steps">
          <span id="step1Label" class="step-label">Step 1 of 2</span>
          <span id="step2Label" class="step-label">Step 2 of 2</span>
        </div>
      </div>

      <!-- Header -->
      <div class="auth-header">
        <i class="fas fa-book-open"></i>
        <h1>Research Paper Organizer</h1>
        <p>Create your account</p>
      </div>

      <!-- Form -->
      <form id="signupForm" class="auth-form" novalidate>
        <!-- STEP 1 -->
        <div id="step1" class="signup-step">
          <div class="form-group">
            <label for="signupName">Full Name <span class="required">*</span></label>
            <div class="input-wrapper">
              <div class="input-container">
                <input type="text" id="signupName" name="name" required placeholder="Enter your full name"/>
                <i class="fas fa-user"></i>
              </div>
              <div id="nameError" class="error-message"></div>
            </div>
          </div>
          <div class="form-group">
            <label for="signupEmail">Email Address <span class="required">*</span></label>
            <div class="input-wrapper">
              <div class="input-container">
                <input type="email" id="signupEmail" name="email" required placeholder="Enter your email"/>
                <i class="fas fa-envelope"></i>
              </div>
              <div id="emailError" class="error-message"></div>
            </div>
          </div>
          <button type="button" class="auth-btn" id="nextStepBtn">Continue</button>
        </div>

        <!-- STEP 2 -->
        <div id="step2" class="signup-step" style="display:none;">
          <div class="form-group">
            <label for="signupPassword">Password <span class="required">*</span></label>
            <div class="input-wrapper">
              <div class="input-container">
                <input type="password" id="signupPassword" name="password" required minlength="8" placeholder="Create a password"/>
                <i class="fas fa-lock"></i>
              </div>

              <!-- Strength Bar -->
              <div id="passwordStrengthBar" style="height: 8px; width: 100%; background: #e5e7eb; border-radius: 4px; margin-top: 8px;">
                <div id="passwordStrengthFill" style="height: 100%; width: 0%; background: red; border-radius: 4px; transition: width 0.3s ease;"></div>
              </div>

              <div id="passwordRequirements" class="password-requirements" style="display:none;">
                <p>Password must contain:</p>
                <ul>
                  <li data-requirement="length" data-text="Need at least 8 characters">Need at least 8 characters</li>
                  <li data-requirement="uppercase" data-text="One uppercase letter">One uppercase letter</li>
                  <li data-requirement="lowercase" data-text="One lowercase letter">One lowercase letter</li>
                  <li data-requirement="number" data-text="One number">One number</li>
                  <li data-requirement="special" data-text="One special character">One special character</li>
                </ul>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="confirmPassword">Confirm Password <span class="required">*</span></label>
            <div class="input-wrapper">
              <div class="input-container">
                <input type="password" id="confirmPassword" name="confirmPassword" required placeholder="Confirm your password"/>
                <i class="fas fa-lock"></i>
              </div>
              <div id="confirmPasswordError" class="error-message"></div>
            </div>
          </div>

          <div class="form-group">
            <div class="checkbox-container">
              <input type="checkbox" id="agreeTerms" required/>
              <label for="agreeTerms">I agree to the <a href="terms-of-service.html">Terms</a> and <a href="privacy.html">Privacy</a></label>
            </div>
          </div>

          <div style="display:flex;gap:10px;">
            <button type="button" class="auth-btn" id="backStepBtn">Back</button>
            <button type="submit" class="auth-btn" id="createAccountBtn" disabled>Create Account</button>
          </div>
        </div>
      </form>
    </div>
  </div>
  

  <!-- JS Logic -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const step1 = document.getElementById('step1');
      const step2 = document.getElementById('step2');
      const nextStepBtn = document.getElementById('nextStepBtn');
      const backStepBtn = document.getElementById('backStepBtn');
      const signupProgressBar = document.getElementById('signupProgressBar');
      const signupName = document.getElementById('signupName');
      const signupEmail = document.getElementById('signupEmail');
      const signupPassword = document.getElementById('signupPassword');
      const confirmPassword = document.getElementById('confirmPassword');
      const agreeTerms = document.getElementById('agreeTerms');
      const createAccountBtn = document.getElementById('createAccountBtn');
      const passwordRequirementsBox = document.getElementById("passwordRequirements");
      const passwordStrengthFill = document.getElementById('passwordStrengthFill');

      function updateProgress() {
        let progress = 0;
        if (signupName.value.trim() && signupEmail.value.trim()) {
          progress = 50;
        }
        if (step2.style.display === "block") {
          const pw = signupPassword.value;
          const cpw = confirmPassword.value;
          const allValid = document.querySelectorAll(".password-requirements li.valid").length === 5;
          if (allValid && pw === cpw && agreeTerms.checked) {
            progress = 100;
          }
        }
        signupProgressBar.style.width = progress + "%";
      }

      nextStepBtn.addEventListener('click', () => {
        if (signupName.value.trim() && signupEmail.value.trim()) {
          step1.style.display = 'none';
          step2.style.display = 'block';
          updateProgress();
        } else {
          document.getElementById('nameError').textContent = signupName.value ? '' : 'Name required';
          document.getElementById('emailError').textContent = signupEmail.value ? '' : 'Email required';
        }
      });

      backStepBtn.addEventListener('click', () => {
        step2.style.display = 'none';
        step1.style.display = 'block';
        updateProgress();
      });

      function updatePasswordRequirements() {
        const pwd = signupPassword.value;
        passwordRequirementsBox.style.display = pwd.length > 0 ? "block" : "none";

        const checks = {
          length: pwd.length >= 8,
          uppercase: /[A-Z]/.test(pwd),
          lowercase: /[a-z]/.test(pwd),
          number: /[0-9]/.test(pwd),
          special: /[^A-Za-z0-9]/.test(pwd)
        };

        let passedCount = 0;
        for (const [req, passed] of Object.entries(checks)) {
          const item = document.querySelector(`[data-requirement="${req}"]`);
          if (item) {
            item.classList.toggle("valid", passed);
            item.textContent = item.dataset.text;
          }
          if (passed) passedCount++;
        }

        const strengthPercent = (passedCount / 5) * 100;
        passwordStrengthFill.style.width = strengthPercent + "%";

        passwordStrengthFill.style.backgroundColor =
          passedCount <= 2 ? "red" :
          passedCount <= 4 ? "orange" : "green";
      }

      function validateStep2() {
        const pw = signupPassword.value;
        const cpw = confirmPassword.value;
        const allValid = document.querySelectorAll(".password-requirements li.valid").length === 5;
        createAccountBtn.disabled = !(allValid && pw === cpw && agreeTerms.checked);
        document.getElementById("confirmPasswordError").textContent =
          pw && cpw && pw !== cpw ? "Passwords do not match" : "";
        updateProgress();
      }

      signupName.addEventListener("input", updateProgress);
      signupEmail.addEventListener("input", updateProgress);
      signupPassword.addEventListener("input", () => {
        updatePasswordRequirements();
        validateStep2();
      });
      confirmPassword.addEventListener("input", validateStep2);
      agreeTerms.addEventListener("change", validateStep2);

      updateProgress();
    });

    // Dark Mode Toggle with Font Awesome icon
    document.addEventListener("DOMContentLoaded", () => {
      const toggle = document.getElementById("darkModeToggle");
      const icon = toggle.querySelector("i");
      const prefersDark = localStorage.getItem("darkMode");

      if (prefersDark === "enabled") {
        document.body.classList.add("dark-mode");
        icon.classList.remove("fa-moon");
        icon.classList.add("fa-sun");
      }

      toggle.addEventListener("click", () => {
        const isDark = document.body.classList.contains("dark-mode");
        document.body.classList.toggle("dark-mode");
        localStorage.setItem("darkMode", isDark ? "disabled" : "enabled");

        if (isDark) {
          icon.classList.remove("fa-sun");
          icon.classList.add("fa-moon");
        } else {
          icon.classList.remove("fa-moon");
          icon.classList.add("fa-sun");
        }
      });
    });
  </script>

  <!-- External JS Files -->
  <script type="module" src="js/auth.js"></script>
  <script src="js/form-validation.js"></script>
</body>
</html>
